---
import { Image } from "astro:assets";

const { posts } = Astro.props as {
  posts: Array<{
    id: string;
    data: {
      thumb: {    src: string;
    width: number;
    height: number;
    format: "png" | "jpg" | "jpeg" | "tiff" | "webp" | "gif" | "svg" | "avif";
};
      description: string;
      date: string;
      title: string;
      tags: string[];
      draft: boolean;
    };
  }>;
};
---

<ul class="gallery">
  {
    posts.map((post) => (
      <li>
        <a
          href={`/blogs/${post.id}`}
          data-astro-prefetch
          class={post.data.draft ? "draft" : ""}
        >
          <figure>
            <Image src={post.data.thumb} alt="" />
            {/* <Image src={getThumb(post.data.thumb) || ""} alt={post.data.description}  /> */}
            <figcaption>
              <time datetime={new Date(post.data.date).toISOString()}>
                {new Date(post.data.date).toLocaleDateString("en-US", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </time>
              <h2>{post.data.title} {post.data.draft ? "(WIP)" : ""}</h2>
              <p>{post.data.description}</p>
              <p id="tags">{post.data.tags.join(", ")}</p>
            </figcaption>
          </figure>
        </a>
      </li>
    ))
  }
</ul>
<style>
  /*
  Reusable gallery component. Used on front page
*/

  .gallery {
    margin-block: 4rem;
    list-style: none;
    padding: 0;

    li {
      margin-bottom: 10%;
    }

    figure {
      transition: transform 0.1s;
      align-items: flex-start;
      display: flex;
      gap: 3rem;
      margin: 3em 0;

      &:hover {
        transform: scale(1.01);
      }
      figcaption {
        margin: auto;
      }

      @media (width < 900) {
        img {
          display: none;
        }
      }
    }

    time {
      color: var(--tan);
      font-weight: 300;
      font-size: 85%;
    }

    h2 {
      color: var(--gray-400);
      text-wrap: balance;
      font-size: 2rem;
      font-weight: 500;
      line-height: 1.5;
      margin: 0;
      text-decoration: underline var(--gray-200) 1px;
    }
  }

  p {
    margin-block: 0.5em;
  }

  #tags {
    color: var(--gray-400);
    font-size: 1rem;
    font-weight: 300;
    margin-top: 0.5em;
    text-decoration: none;
  }

  img {
    max-width: 400px;
    min-width: 200px;
  }

  .draft {
    opacity: 0.5;
    }
  }
</style>
